---
title: "R Notebook"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}

library(plyr)
library(dplyr)
library(kableExtra)
library(gmodels)
library(reshape)
library(tidyr)
library(knitr)
library(plotly)
if (!require("processx")) install.packages("processx")
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 

color_csv<-read.csv(file = "../../csv/csv_report_color.csv", skip='0', sep = ";", header = FALSE)

elements<-read.csv(file = "../../csv/csv_report_elements.csv", skip='0', sep = ";", header = FALSE)

colnames(color_csv) <- c("filename","project_id","element_type","color","E")
colnames(elements) <- c("project_id","diagram_id","element_id","type","name","in_class","asso_type","visibility","format", "begin_format")

color_csv <- color_csv %>%  group_by(project_id, element_type, color) %>% mutate(brightness = as.vector(col2hsl(color))[3]) %>% group_by(project_id, element_type, color, brightness)

colors_by_diagram <- color_csv %>% group_by(project_id, element_type) %>% tally()



analysis_elements <- elements %>% group_by(diagram_id, type) %>% tally()
type_of_elements <- elements %>% group_by(type) %>% tally()


library(plotly)

library(plotwidgets)
x <- "#FF2400FF"
as.vector(col2hsl(x))[3]

```
# Elements in diagrams
```{r}

temp <- elements %>% group_by(V4) %>% tally() %>% arrange(n) %>% ungroup()
fig <- plot_ly(temp, x = ~V4, y = ~n, name = "SF Zoo",type = "bar") %>% 
  layout(title = "Mean Depth for each Clarity Category", xaxis = list(categoryorder = "array", categoryarray = ~n)
  )

fig

```

